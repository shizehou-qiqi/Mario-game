<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é©¬é‡Œå¥¥æ¸¸æˆ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>é©¬é‡Œå¥¥æ¸¸æˆ</h1>
            <div class="game-info">
                <span id="score">åˆ†æ•°: 0</span>
                <span id="lives">ç”Ÿå‘½: 3</span>
            </div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="game-controls">
            <p>æ§åˆ¶è¯´æ˜ï¼š</p>
            <p>â† â†’ æ–¹å‘é”®ç§»åŠ¨ï¼Œç©ºæ ¼é”®æˆ–â†‘è·³è·ƒ</p>
        </div>
        
        <div class="game-menu" id="gameMenu" style="display: block; z-index: 1000;">
            <h2>ğŸ® é©¬é‡Œå¥¥æ¸¸æˆ</h2>
            <button id="startButton" style="background: #FF6B35; color: white; padding: 15px 30px; font-size: 1.2em; border: none; border-radius: 5px; cursor: pointer;">ğŸš€ å¼€å§‹æ¸¸æˆ</button>
            <button id="pauseButton" style="display: none;">æš‚åœ</button>
            <p style="margin-top: 15px; color: #666;">ç‚¹å‡»å¼€å§‹æŒ‰é’®å¼€å§‹æ¸¸æˆï¼</p>
        </div>
        
        <div class="game-over" id="gameOver" style="display: none;">
            <h2>æ¸¸æˆç»“æŸ</h2>
            <p>æœ€ç»ˆåˆ†æ•°: <span id="finalScore">0</span></p>
            <button id="restartButton">é‡æ–°å¼€å§‹</button>
            <button class="menu-button">è¿”å›èœå•</button>
        </div>
        
        <div class="victory-screen" id="victoryScreen" style="display: none;">
            <h2>æ­å–œé€šå…³ï¼</h2>
            <p>å…³å¡åˆ†æ•°: <span id="victoryScore">0</span></p>
            <button id="nextLevelButton">ä¸‹ä¸€å…³</button>
            <button class="menu-button">è¿”å›èœå•</button>
        </div>
        
        <div class="pause-overlay" id="pauseOverlay" style="display: none;">
            <h2>æ¸¸æˆæš‚åœ</h2>
            <button id="continueButton">ç»§ç»­æ¸¸æˆ</button>
            <button class="menu-button">è¿”å›èœå•</button>
        </div>
    </div>
    
    <script src="js/vector2d.js"></script>
    <script src="js/physics.js"></script>
    <script src="js/spriteManager.js"></script>
    <script src="js/gameObject.js"></script>
    <script src="js/eventManager.js"></script>
    <script src="js/audioManager.js"></script>
    <script src="js/particleSystem.js"></script>
    <script src="js/inputManager.js"></script>
    <script src="js/platform.js"></script>
    <script src="js/enemy.js"></script>
    <script src="js/collectible.js"></script>
    <script src="js/level.js"></script>
    <script src="js/scoreManager.js"></script>
    <script src="js/hudManager.js"></script>
    <script src="js/player.js"></script>
    <script src="js/gameEngine.js"></script>
    <script src="js/gameStateManager.js"></script>
    <script src="js/main.js"></script>

    <script>
        // è°ƒè¯•ä»£ç ï¼šç›‘å¬é”™è¯¯å’Œæµ‹è¯•æŒ‰é’®åŠŸèƒ½
        console.log('ğŸ® é©¬é‡Œå¥¥æ¸¸æˆè°ƒè¯•æ¨¡å¼å¯åŠ¨');

        // ç›‘å¬JavaScripté”™è¯¯
        window.addEventListener('error', function(event) {
            if (event.error) {
                console.error('âŒ JavaScripté”™è¯¯:', event.error.message);
                console.error('ğŸ“ æ–‡ä»¶:', event.filename + ':' + event.lineno);
                console.error('ğŸ“‹ å †æ ˆ:', event.error.stack);

                // åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'position: fixed; top: 10px; left: 10px; background: red; color: white; padding: 10px; z-index: 9999; max-width: 400px; font-family: monospace; font-size: 12px;';
                errorDiv.innerHTML = `<strong>é”™è¯¯:</strong> ${event.error.message}<br><strong>æ–‡ä»¶:</strong> ${event.filename}:${event.lineno}`;
                document.body.appendChild(errorDiv);
            } else {
                console.error('âŒ æœªçŸ¥é”™è¯¯:', event);
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆåçš„é¢å¤–æ£€æŸ¥
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… DOMåŠ è½½å®Œæˆ');

            // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å®Œæˆ
            setTimeout(() => {
                console.log('ğŸ” æ£€æŸ¥æ¸¸æˆç»„ä»¶...');

                // æ£€æŸ¥å…³é”®å‡½æ•°å’Œç±»
                const components = [
                    { name: 'initGame', type: 'function' },
                    { name: 'GameEngine', type: 'class' },
                    { name: 'GameStateManager', type: 'class' },
                    { name: 'EventManager', type: 'class' }
                ];

                let allComponentsLoaded = true;

                components.forEach(component => {
                    if (typeof window[component.name] !== 'undefined') {
                        console.log(`âœ… ${component.name} ${component.type} å·²åŠ è½½`);
                    } else {
                        console.error(`âŒ ${component.name} ${component.type} æœªæ‰¾åˆ°`);
                        allComponentsLoaded = false;
                    }
                });

                // æ£€æŸ¥æŒ‰é’®å…ƒç´ 
                const startButton = document.getElementById('startButton');
                if (startButton) {
                    console.log('âœ… å¼€å§‹æŒ‰é’®å…ƒç´ æ‰¾åˆ°');

                    // æ·»åŠ é¢å¤–çš„ç‚¹å‡»ç›‘å¬å™¨ç”¨äºè°ƒè¯•
                    startButton.addEventListener('click', function() {
                        console.log('ğŸ–±ï¸ å¼€å§‹æŒ‰é’®è¢«ç‚¹å‡»ï¼');
                    });
                } else {
                    console.error('âŒ å¼€å§‹æŒ‰é’®å…ƒç´ æœªæ‰¾åˆ°');
                    allComponentsLoaded = false;
                }

                if (allComponentsLoaded) {
                    console.log('ğŸ‰ æ‰€æœ‰ç»„ä»¶æ£€æŸ¥é€šè¿‡ï¼');

                    // ğŸ”§ é‡è¦ï¼šè°ƒç”¨æ¸¸æˆåˆå§‹åŒ–å‡½æ•°
                    console.log('ğŸš€ å¼€å§‹åˆå§‹åŒ–æ¸¸æˆ...');
                    try {
                        initGame();
                        console.log('âœ… æ¸¸æˆåˆå§‹åŒ–æˆåŠŸï¼');
                    } catch (error) {
                        console.error('âŒ æ¸¸æˆåˆå§‹åŒ–å¤±è´¥:', error);
                    }
                } else {
                    console.error('âš ï¸ éƒ¨åˆ†ç»„ä»¶ç¼ºå¤±ï¼Œæ¸¸æˆå¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ');
                }

            }, 1000);
        });

        console.log('ğŸ”§ è°ƒè¯•è„šæœ¬åŠ è½½å®Œæˆ');
    </script>
</body>
</html>