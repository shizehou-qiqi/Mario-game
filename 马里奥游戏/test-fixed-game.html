<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®å¤åçš„é©¬é‡Œå¥¥æ¸¸æˆæµ‹è¯•</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-width: 300px;
            z-index: 10000;
        }
        .debug-panel h4 {
            margin: 0 0 10px 0;
            color: #4CAF50;
        }
        .debug-log {
            max-height: 200px;
            overflow-y: auto;
            background: #111;
            padding: 5px;
            border-radius: 3px;
        }
        .log-error { color: #ff6b6b; }
        .log-success { color: #4ecdc4; }
        .log-warning { color: #ffa726; }
        .log-info { color: #42a5f5; }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>ä¿®å¤åçš„é©¬é‡Œå¥¥æ¸¸æˆ</h1>
            <div class="game-info">
                <span id="score">åˆ†æ•°: 0</span>
                <span id="lives">ç”Ÿå‘½: 3</span>
            </div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="game-controls">
            <p>æ§åˆ¶è¯´æ˜ï¼š</p>
            <p>â† â†’ æ–¹å‘é”®ç§»åŠ¨ï¼Œç©ºæ ¼é”®æˆ–â†‘è·³è·ƒ</p>
        </div>
        
        <div class="game-menu" id="gameMenu" style="display: block; z-index: 1000;">
            <h2>ğŸ® ä¿®å¤åçš„é©¬é‡Œå¥¥æ¸¸æˆ</h2>
            <button id="startButton" style="background: #FF6B35; color: white; padding: 15px 30px; font-size: 1.2em; border: none; border-radius: 5px; cursor: pointer;">ğŸš€ å¼€å§‹æ¸¸æˆ</button>
            <button id="pauseButton" style="display: none;">æš‚åœ</button>
            <p style="margin-top: 15px; color: #666;">ç‚¹å‡»å¼€å§‹æŒ‰é’®å¼€å§‹æ¸¸æˆï¼</p>
            <p style="margin-top: 10px; color: #999; font-size: 0.9em;">âœ¨ å·²ä¿®å¤å¯åŠ¨å¡ä½é—®é¢˜</p>
        </div>
        
        <div class="game-over" id="gameOver" style="display: none;">
            <h2>æ¸¸æˆç»“æŸ</h2>
            <p>æœ€ç»ˆåˆ†æ•°: <span id="finalScore">0</span></p>
            <button id="restartButton">é‡æ–°å¼€å§‹</button>
            <button class="menu-button">è¿”å›èœå•</button>
        </div>
        
        <div class="victory-screen" id="victoryScreen" style="display: none;">
            <h2>æ­å–œé€šå…³ï¼</h2>
            <p>å…³å¡åˆ†æ•°: <span id="victoryScore">0</span></p>
            <button id="nextLevelButton">ä¸‹ä¸€å…³</button>
            <button class="menu-button">è¿”å›èœå•</button>
        </div>
        
        <div class="pause-overlay" id="pauseOverlay" style="display: none;">
            <h2>æ¸¸æˆæš‚åœ</h2>
            <button id="continueButton">ç»§ç»­æ¸¸æˆ</button>
            <button class="menu-button">è¿”å›èœå•</button>
        </div>
    </div>
    
    <!-- è°ƒè¯•é¢æ¿ -->
    <div class="debug-panel">
        <h4>ğŸ”§ è°ƒè¯•ä¿¡æ¯</h4>
        <div class="debug-log" id="debugLog">
            ç­‰å¾…æ¸¸æˆåˆå§‹åŒ–...<br>
        </div>
        <button onclick="clearDebugLog()" style="background: #666; color: white; border: none; padding: 3px 6px; border-radius: 2px; font-size: 10px; margin-top: 5px;">æ¸…ç©º</button>
    </div>
    
    <!-- åŠ è½½æ‰€æœ‰æ¸¸æˆè„šæœ¬ -->
    <script src="js/vector2d.js"></script>
    <script src="js/physics.js"></script>
    <script src="js/spriteManager.js"></script>
    <script src="js/gameObject.js"></script>
    <script src="js/eventManager.js"></script>
    <script src="js/audioManager.js"></script>
    <script src="js/particleSystem.js"></script>
    <script src="js/inputManager.js"></script>
    <script src="js/platform.js"></script>
    <script src="js/enemy.js"></script>
    <script src="js/collectible.js"></script>
    <script src="js/level.js"></script>
    <script src="js/scoreManager.js"></script>
    <script src="js/hudManager.js"></script>
    <script src="js/player.js"></script>
    <script src="js/gameEngine.js"></script>
    <script src="js/gameStateManager.js"></script>
    <script src="js/main.js"></script>

    <script>
        // è°ƒè¯•æ—¥å¿—ç³»ç»Ÿ
        let debugLogDiv = document.getElementById('debugLog');
        
        function debugLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const className = `log-${type}`;
            debugLogDiv.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span><br>`;
            debugLogDiv.scrollTop = debugLogDiv.scrollHeight;
        }
        
        function clearDebugLog() {
            debugLogDiv.innerHTML = 'æ—¥å¿—å·²æ¸…ç©º<br>';
        }
        
        // é‡å†™consoleæ–¹æ³•ä»¥æ˜¾ç¤ºåœ¨è°ƒè¯•é¢æ¿
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            debugLog(args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            debugLog(args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            debugLog(args.join(' '), 'warning');
        };
        
        // ç›‘å¬JavaScripté”™è¯¯
        window.addEventListener('error', function(event) {
            debugLog(`ğŸ’¥ é”™è¯¯: ${event.error.message}`, 'error');
            debugLog(`ğŸ“ æ–‡ä»¶: ${event.filename}:${event.lineno}`, 'error');
        });
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('ğŸ“„ DOMåŠ è½½å®Œæˆ', 'success');
            
            // å»¶è¿Ÿæ£€æŸ¥ï¼Œç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å®Œæˆ
            setTimeout(() => {
                debugLog('ğŸ” æ£€æŸ¥æ¸¸æˆç»„ä»¶...', 'info');
                
                // æ£€æŸ¥å…³é”®ç»„ä»¶
                const components = ['initGame', 'GameEngine', 'GameStateManager', 'EventManager'];
                let allLoaded = true;
                
                components.forEach(component => {
                    if (typeof window[component] !== 'undefined') {
                        debugLog(`âœ… ${component} å·²åŠ è½½`, 'success');
                    } else {
                        debugLog(`âŒ ${component} æœªæ‰¾åˆ°`, 'error');
                        allLoaded = false;
                    }
                });
                
                if (allLoaded) {
                    debugLog('ğŸ‰ æ‰€æœ‰ç»„ä»¶æ£€æŸ¥é€šè¿‡ï¼', 'success');
                    debugLog('ğŸš€ å¼€å§‹åˆå§‹åŒ–æ¸¸æˆ...', 'info');
                    
                    try {
                        initGame();
                        debugLog('âœ… æ¸¸æˆåˆå§‹åŒ–æˆåŠŸï¼', 'success');
                    } catch (error) {
                        debugLog(`âŒ æ¸¸æˆåˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
                    }
                } else {
                    debugLog('âš ï¸ éƒ¨åˆ†ç»„ä»¶ç¼ºå¤±ï¼Œæ¸¸æˆå¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ', 'warning');
                }
            }, 1000);
        });
        
        debugLog('ğŸ”§ è°ƒè¯•ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ', 'success');
    </script>
</body>
</html>
